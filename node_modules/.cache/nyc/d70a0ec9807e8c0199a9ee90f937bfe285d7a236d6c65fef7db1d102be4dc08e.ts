"use strict";var cov_1i3br47e01=function(){var path="/Users/fastpagamentos/development/Testes/graphql-2/src/graphql/resources/user/user.resolvers.ts";var hash="3f7fe349d11daea172bdcf78f8a5ae9acb64961a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/fastpagamentos/development/Testes/graphql-2/src/graphql/resources/user/user.resolvers.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:16},end:{line:3,column:49}},"2":{start:{line:4,column:30},end:{line:4,column:77}},"3":{start:{line:5,column:24},end:{line:5,column:65}},"4":{start:{line:6,column:0},end:{line:97,column:2}},"5":{start:{line:9,column:12},end:{line:16,column:44}},"6":{start:{line:21,column:12},end:{line:27,column:44}},"7":{start:{line:30,column:12},end:{line:30,column:30}},"8":{start:{line:31,column:12},end:{line:40,column:44}},"9":{start:{line:36,column:16},end:{line:37,column:68}},"10":{start:{line:37,column:20},end:{line:37,column:68}},"11":{start:{line:38,column:16},end:{line:38,column:28}},"12":{start:{line:43,column:12},end:{line:49,column:44}},"13":{start:{line:46,column:16},end:{line:46,column:83}},"14":{start:{line:47,column:16},end:{line:47,column:28}},"15":{start:{line:54,column:12},end:{line:58,column:44}},"16":{start:{line:55,column:16},end:{line:56,column:55}},"17":{start:{line:61,column:12},end:{line:69,column:44}},"18":{start:{line:62,column:16},end:{line:67,column:19}},"19":{start:{line:65,column:20},end:{line:65,column:87}},"20":{start:{line:66,column:20},end:{line:66,column:66}},"21":{start:{line:72,column:12},end:{line:83,column:44}},"22":{start:{line:73,column:16},end:{line:81,column:19}},"23":{start:{line:76,column:20},end:{line:76,column:87}},"24":{start:{line:77,column:20},end:{line:80,column:23}},"25":{start:{line:79,column:24},end:{line:79,column:38}},"26":{start:{line:86,column:12},end:{line:94,column:44}},"27":{start:{line:87,column:16},end:{line:92,column:19}},"28":{start:{line:90,column:20},end:{line:90,column:87}},"29":{start:{line:91,column:20},end:{line:91,column:60}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:15},end:{line:8,column:16}},loc:{start:{line:8,column:68},end:{line:17,column:9}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:15},end:{line:20,column:16}},loc:{start:{line:20,column:68},end:{line:28,column:9}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:29,column:14},end:{line:29,column:15}},loc:{start:{line:29,column:47},end:{line:41,column:9}},line:29},"3":{name:"(anonymous_3)",decl:{start:{line:35,column:22},end:{line:35,column:23}},loc:{start:{line:35,column:32},end:{line:39,column:13}},line:35},"4":{name:"(anonymous_4)",decl:{start:{line:42,column:85},end:{line:42,column:86}},loc:{start:{line:42,column:119},end:{line:50,column:9}},line:42},"5":{name:"(anonymous_5)",decl:{start:{line:45,column:22},end:{line:45,column:23}},loc:{start:{line:45,column:32},end:{line:48,column:13}},line:45},"6":{name:"(anonymous_6)",decl:{start:{line:53,column:20},end:{line:53,column:21}},loc:{start:{line:53,column:49},end:{line:59,column:9}},line:53},"7":{name:"(anonymous_7)",decl:{start:{line:54,column:44},end:{line:54,column:45}},loc:{start:{line:54,column:51},end:{line:57,column:13}},line:54},"8":{name:"(anonymous_8)",decl:{start:{line:60,column:84},end:{line:60,column:85}},loc:{start:{line:60,column:123},end:{line:70,column:9}},line:60},"9":{name:"(anonymous_9)",decl:{start:{line:61,column:44},end:{line:61,column:45}},loc:{start:{line:61,column:51},end:{line:68,column:13}},line:61},"10":{name:"(anonymous_10)",decl:{start:{line:64,column:26},end:{line:64,column:27}},loc:{start:{line:64,column:36},end:{line:67,column:17}},line:64},"11":{name:"(anonymous_11)",decl:{start:{line:71,column:92},end:{line:71,column:93}},loc:{start:{line:71,column:131},end:{line:84,column:9}},line:71},"12":{name:"(anonymous_12)",decl:{start:{line:72,column:44},end:{line:72,column:45}},loc:{start:{line:72,column:51},end:{line:82,column:13}},line:72},"13":{name:"(anonymous_13)",decl:{start:{line:75,column:26},end:{line:75,column:27}},loc:{start:{line:75,column:36},end:{line:81,column:17}},line:75},"14":{name:"(anonymous_14)",decl:{start:{line:78,column:30},end:{line:78,column:31}},loc:{start:{line:78,column:40},end:{line:80,column:21}},line:78},"15":{name:"(anonymous_15)",decl:{start:{line:85,column:84},end:{line:85,column:85}},loc:{start:{line:85,column:118},end:{line:95,column:9}},line:85},"16":{name:"(anonymous_16)",decl:{start:{line:86,column:44},end:{line:86,column:45}},loc:{start:{line:86,column:51},end:{line:93,column:13}},line:86},"17":{name:"(anonymous_17)",decl:{start:{line:89,column:26},end:{line:89,column:27}},loc:{start:{line:89,column:36},end:{line:92,column:17}},line:89}},branchMap:{"0":{loc:{start:{line:8,column:24},end:{line:8,column:34}},type:"default-arg",locations:[{start:{line:8,column:32},end:{line:8,column:34}}],line:8},"1":{loc:{start:{line:8,column:36},end:{line:8,column:46}},type:"default-arg",locations:[{start:{line:8,column:45},end:{line:8,column:46}}],line:8},"2":{loc:{start:{line:20,column:24},end:{line:20,column:34}},type:"default-arg",locations:[{start:{line:20,column:32},end:{line:20,column:34}}],line:20},"3":{loc:{start:{line:20,column:36},end:{line:20,column:46}},type:"default-arg",locations:[{start:{line:20,column:45},end:{line:20,column:46}}],line:20},"4":{loc:{start:{line:36,column:16},end:{line:37,column:68}},type:"if",locations:[{start:{line:36,column:16},end:{line:37,column:68}},{start:{line:36,column:16},end:{line:37,column:68}}],line:36}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{"0":[0],"1":[0],"2":[0],"3":[0],"4":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"3f7fe349d11daea172bdcf78f8a5ae9acb64961a"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_1i3br47e01.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const utils_1=(cov_1i3br47e01.s[1]++,require("../../../helpers/utils"));const composable_resolver_1=(cov_1i3br47e01.s[2]++,require("../../composable/composable.resolver"));const auth_resolver_1=(cov_1i3br47e01.s[3]++,require("../../composable/auth.resolver"));cov_1i3br47e01.s[4]++;exports.userResolvers={User:{posts:(user,{limit=(cov_1i3br47e01.b[0][0]++,10),offset=(cov_1i3br47e01.b[1][0]++,0)},context,info)=>{cov_1i3br47e01.f[0]++;cov_1i3br47e01.s[5]++;return context.db.Post.findAll({where:{author:user.id},limit:limit,offset:offset,attributes:context.requestedFields.getFields(info,{keep:['id'],exclude:['comments']})}).catch(utils_1.handleError);}},Query:{users:(user,{limit=(cov_1i3br47e01.b[2][0]++,10),offset=(cov_1i3br47e01.b[3][0]++,0)},context,info)=>{cov_1i3br47e01.f[1]++;cov_1i3br47e01.s[6]++;return context.db.User.findAll({limit:limit,offset:offset,attributes:context.requestedFields.getFields(info,{keep:['id'],exclude:['posts']})}).catch(utils_1.handleError);},user:(user,{id},context,info)=>{cov_1i3br47e01.f[2]++;cov_1i3br47e01.s[7]++;id=parseInt(id);cov_1i3br47e01.s[8]++;return context.db.User.findById(id,{attributes:context.requestedFields.getFields(info,{keep:['id'],exclude:['posts']})}).then(user=>{cov_1i3br47e01.f[3]++;cov_1i3br47e01.s[9]++;if(!user){cov_1i3br47e01.b[4][0]++;cov_1i3br47e01.s[10]++;throw new Error(`User with id ${id} not found`);}else{cov_1i3br47e01.b[4][1]++;}cov_1i3br47e01.s[11]++;return user;}).catch(utils_1.handleError);},currentUser:composable_resolver_1.compose(...auth_resolver_1.authResolvers)((user,args,{db,authUser})=>{cov_1i3br47e01.f[4]++;cov_1i3br47e01.s[12]++;return db.User.findById(authUser.id).then(user=>{cov_1i3br47e01.f[5]++;cov_1i3br47e01.s[13]++;utils_1.throwError(!user,`User with id ${authUser.id} not found`);cov_1i3br47e01.s[14]++;return user;}).catch(utils_1.handleError);})},Mutation:{createUser:(user,{input},{db})=>{cov_1i3br47e01.f[6]++;cov_1i3br47e01.s[15]++;return db.sequelize.transaction(t=>{cov_1i3br47e01.f[7]++;cov_1i3br47e01.s[16]++;return db.User.create(input,{transaction:t});}).catch(utils_1.handleError);},updateUser:composable_resolver_1.compose(...auth_resolver_1.authResolvers)((user,{input},{db,authUser})=>{cov_1i3br47e01.f[8]++;cov_1i3br47e01.s[17]++;return db.sequelize.transaction(t=>{cov_1i3br47e01.f[9]++;cov_1i3br47e01.s[18]++;return db.User.findById(authUser.id).then(user=>{cov_1i3br47e01.f[10]++;cov_1i3br47e01.s[19]++;utils_1.throwError(!user,`User with id ${authUser.id} not found`);cov_1i3br47e01.s[20]++;return user.update(input,{transaction:t});});}).catch(utils_1.handleError);}),updateUserPassword:composable_resolver_1.compose(...auth_resolver_1.authResolvers)((user,{input},{db,authUser})=>{cov_1i3br47e01.f[11]++;cov_1i3br47e01.s[21]++;return db.sequelize.transaction(t=>{cov_1i3br47e01.f[12]++;cov_1i3br47e01.s[22]++;return db.User.findById(authUser.id).then(user=>{cov_1i3br47e01.f[13]++;cov_1i3br47e01.s[23]++;utils_1.throwError(!user,`User with id ${authUser.id} not found`);cov_1i3br47e01.s[24]++;return user.update(input,{transaction:t}).then(user=>{cov_1i3br47e01.f[14]++;cov_1i3br47e01.s[25]++;return!!user;});});}).catch(utils_1.handleError);}),deleteUser:composable_resolver_1.compose(...auth_resolver_1.authResolvers)((user,args,{db,authUser})=>{cov_1i3br47e01.f[15]++;cov_1i3br47e01.s[26]++;return db.sequelize.transaction(t=>{cov_1i3br47e01.f[16]++;cov_1i3br47e01.s[27]++;return db.User.findById(authUser.id).then(user=>{cov_1i3br47e01.f[17]++;cov_1i3br47e01.s[28]++;utils_1.throwError(!user,`User with id ${authUser.id} not found`);cov_1i3br47e01.s[29]++;return user.destroy({transaction:t});});}).catch(utils_1.handleError);})}};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2Zhc3RwYWdhbWVudG9zL2RldmVsb3BtZW50L1Rlc3Rlcy9ncmFwaHFsLTIvc3JjL2dyYXBocWwvcmVzb3VyY2VzL3VzZXIvdXNlci5yZXNvbHZlcnMudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9mYXN0cGFnYW1lbnRvcy9kZXZlbG9wbWVudC9UZXN0ZXMvZ3JhcGhxbC0yL3NyYy9ncmFwaHFsL3Jlc291cmNlcy91c2VyL3VzZXIucmVzb2x2ZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBTUEsa0RBQWlFO0FBQ2pFLDhFQUErRDtBQUMvRCxrRUFBK0Q7QUFJbEQsUUFBQSxhQUFhLEdBQUc7SUFFekIsSUFBSSxFQUFFO1FBQ0YsS0FBSyxFQUFFLENBQUMsSUFBa0IsRUFBRSxFQUFFLEtBQUssR0FBRyxFQUFFLEVBQUUsTUFBTSxHQUFHLENBQUMsRUFBRSxFQUFFLE9BQXdCLEVBQUUsSUFBSSxFQUFFLEVBQUU7WUFDdEYsT0FBTyxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUk7aUJBQ2pCLE9BQU8sQ0FBQztnQkFDTCxLQUFLLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBQztnQkFDeEIsS0FBSyxFQUFFLEtBQUs7Z0JBQ1osTUFBTSxFQUFFLE1BQU07Z0JBQ2QsVUFBVSxFQUFFLE9BQU8sQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFDLENBQUM7YUFDOUYsQ0FBQztpQkFDRCxLQUFLLENBQUMsbUJBQVcsQ0FBQyxDQUFBO1FBQzNCLENBQUM7S0FDSjtJQUVELEtBQUssRUFBRTtRQUNILEtBQUssRUFBRSxDQUFDLElBQWtCLEVBQUUsRUFBRSxLQUFLLEdBQUcsRUFBRSxFQUFFLE1BQU0sR0FBRyxDQUFDLEVBQUUsRUFBRSxPQUF3QixFQUFFLElBQXdCLEVBQUUsRUFBRTtZQUMxRyxPQUFP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QUFXLENBQUMsQ0FBQyxDQUFjLEVBQUUsRUFBRTtnQkFDL0MsT0FBTyxFQUFFLENBQUMsSUFBSTtxQkFDVCxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztxQkFDckIsSUFBSSxDQUFDLENBQUMsSUFBa0IsRUFBRSxFQUFFO29CQUN6QixrQkFBVSxDQUFDLENBQUMsSUFBSSxFQUFFLGdCQUFnQixRQUFRLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQTtvQkFDMUQsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUE7Z0JBQzNDLENBQUMsQ0FBQyxDQUFBO1lBQ1YsQ0FBQyxDQUFDO2lCQUNHLEtBQUssQ0FBQyxtQkFBVyxDQUFDLENBQUE7UUFDM0IsQ0FBQyxDQUFDO0tBQ0w7Q0FFSixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVxdWVzdGVkRmllbGQgfSBmcm9tICcuLy4uLy4uL2FzdC9SZXF1ZXN0ZWRGaWVsZCc7XG5pbXBvcnQgeyBBdXRoVXNlciB9IGZyb20gJy4vLi4vLi4vLi4vaW50ZXJmYWNlcy9BdXRoVXNlckludGVyZmFjZSc7XG5pbXBvcnQgeyBnZW5lcmljR2V0QWxsLCBnZW5lcmljR2V0QnlJZCB9IGZyb20gJy4vLi4vLi4vZ2VuZXJpYyc7XG5pbXBvcnQgeyBVc2VySW5zdGFuY2UgfSBmcm9tICcuLy4uLy4uLy4uL21vZGVscy9Vc2VyTW9kZWwnO1xuaW1wb3J0IHsgRGJDb25uZWN0aW9uIH0gZnJvbSAnLi8uLi8uLi8uLi9pbnRlcmZhY2VzL0RiQ29ubmVjdGlvbkludGVyZmFjZSc7XG5pbXBvcnQgeyBUcmFuc2FjdGlvbiB9IGZyb20gJ3NlcXVlbGl6ZSc7XG5pbXBvcnQgeyBoYW5kbGVFcnJvciwgdGhyb3dFcnJvciB9IGZyb20gJy4uLy4uLy4uL2hlbHBlcnMvdXRpbHMnO1xuaW1wb3J0IHsgY29tcG9zZSB9IGZyb20gJy4uLy4uL2NvbXBvc2FibGUvY29tcG9zYWJsZS5yZXNvbHZlcic7XG5pbXBvcnQgeyBhdXRoUmVzb2x2ZXJzIH0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZS9hdXRoLnJlc29sdmVyJztcbmltcG9ydCB7IFJlc29sdmVyQ29udGV4dCB9IGZyb20gJy4uLy4uLy4uL2ludGVyZmFjZXMvUmVzb2x2ZXJDb250ZXh0SW50ZXJmYWNlJztcbmltcG9ydCB7IEdyYXBoUUxSZXNvbHZlSW5mbyB9IGZyb20gJ2dyYXBocWwnO1xuXG5leHBvcnQgY29uc3QgdXNlclJlc29sdmVycyA9IHtcblxuICAgIFVzZXI6IHtcbiAgICAgICAgcG9zdHM6ICh1c2VyOiBVc2VySW5zdGFuY2UsIHsgbGltaXQgPSAxMCwgb2Zmc2V0ID0gMCB9LCBjb250ZXh0OiBSZXNvbHZlckNvbnRleHQsIGluZm8pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRiLlBvc3RcbiAgICAgICAgICAgICAgICAuZmluZEFsbCh7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7YXV0aG9yOiB1c2VyLmlkfSxcbiAgICAgICAgICAgICAgICAgICAgbGltaXQ6IGxpbWl0LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogY29udGV4dC5yZXF1ZXN0ZWRGaWVsZHMuZ2V0RmllbGRzKGluZm8sIHsga2VlcDogWydpZCddLCBleGNsdWRlOiBbJ2NvbW1lbnRzJ119KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKVxuICAgICAgICB9LFxuICAgIH0sXG5cbiAgICBRdWVyeToge1xuICAgICAgICB1c2VyczogKHVzZXI6IFVzZXJJbnN0YW5jZSwgeyBsaW1pdCA9IDEwLCBvZmZzZXQgPSAwIH0sIGNvbnRleHQ6IFJlc29sdmVyQ29udGV4dCwgaW5mbzogR3JhcGhRTFJlc29sdmVJbmZvKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5kYi5Vc2VyXG4gICAgICAgICAgICAgICAgLmZpbmRBbGwoe1xuICAgICAgICAgICAgICAgICAgICBsaW1pdDogbGltaXQsXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBjb250ZXh0LnJlcXVlc3RlZEZpZWxkcy5nZXRGaWVsZHMoaW5mbywgeyBrZWVwOiBbJ2lkJ10sIGV4Y2x1ZGU6IFsncG9zdHMnXSB9KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKVxuICAgICAgICB9LFxuXG4gICAgICAgIHVzZXI6ICh1c2VyOiBVc2VySW5zdGFuY2UsIHsgaWQgfSwgY29udGV4dDogUmVzb2x2ZXJDb250ZXh0LCBpbmZvOiBHcmFwaFFMUmVzb2x2ZUluZm8pID0+IHtcbiAgICAgICAgICAgIGlkID0gcGFyc2VJbnQoaWQpXG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5kYi5Vc2VyXG4gICAgICAgICAgICAgICAgLmZpbmRCeUlkKGlkLCB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGNvbnRleHQucmVxdWVzdGVkRmllbGRzLmdldEZpZWxkcyhpbmZvLCB7IGtlZXA6IFsnaWQnXSwgZXhjbHVkZTogWydwb3N0cyddIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbigodXNlcjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IEVycm9yKGBVc2VyIHdpdGggaWQgJHtpZH0gbm90IGZvdW5kYClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXI7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpXG4gICAgICAgIH0sXG5cbiAgICAgICAgY3VycmVudFVzZXI6IGNvbXBvc2UoLi4uYXV0aFJlc29sdmVycykoKHVzZXI6IFVzZXJJbnN0YW5jZSwgYXJncywgeyBkYiwgYXV0aFVzZXIgfTogeyBkYjogRGJDb25uZWN0aW9uLCBhdXRoVXNlcjogQXV0aFVzZXIgfSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRiLlVzZXJcbiAgICAgICAgICAgICAgICAuZmluZEJ5SWQoYXV0aFVzZXIuaWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHVzZXI6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKCF1c2VyLCBgVXNlciB3aXRoIGlkICR7YXV0aFVzZXIuaWR9IG5vdCBmb3VuZGApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcilcbiAgICAgICAgfSksXG4gICAgfSxcblxuICAgIE11dGF0aW9uOiB7XG4gICAgICAgIGNyZWF0ZVVzZXI6ICh1c2VyOiBVc2VySW5zdGFuY2UsIHsgaW5wdXQgfSwgeyBkYiB9OiB7IGRiOiBEYkNvbm5lY3Rpb24gfSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRiLnNlcXVlbGl6ZS50cmFuc2FjdGlvbigodDogVHJhbnNhY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGIuVXNlclxuICAgICAgICAgICAgICAgICAgICAuY3JlYXRlKGlucHV0LCB7IHRyYW5zYWN0aW9uOiB0IH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcilcbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGVVc2VyOiBjb21wb3NlKC4uLmF1dGhSZXNvbHZlcnMpKCh1c2VyOiBVc2VySW5zdGFuY2UsIHsgaW5wdXQgfSwgeyBkYiwgYXV0aFVzZXIgfTogeyBkYjogRGJDb25uZWN0aW9uLCBhdXRoVXNlcjogQXV0aFVzZXIgfSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRiLnNlcXVlbGl6ZS50cmFuc2FjdGlvbigodDogVHJhbnNhY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGIuVXNlclxuICAgICAgICAgICAgICAgICAgICAuZmluZEJ5SWQoYXV0aFVzZXIuaWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCh1c2VyOiBVc2VySW5zdGFuY2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3IoIXVzZXIsIGBVc2VyIHdpdGggaWQgJHthdXRoVXNlci5pZH0gbm90IGZvdW5kYClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLnVwZGF0ZShpbnB1dCwgeyB0cmFuc2FjdGlvbjogdCB9KVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpXG4gICAgICAgIH0pLFxuXG4gICAgICAgIHVwZGF0ZVVzZXJQYXNzd29yZDogY29tcG9zZSguLi5hdXRoUmVzb2x2ZXJzKSgodXNlcjogVXNlckluc3RhbmNlLCB7IGlucHV0IH0sIHsgZGIsIGF1dGhVc2VyIH06IHsgZGI6IERiQ29ubmVjdGlvbiwgYXV0aFVzZXI6IEF1dGhVc2VyIH0pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYi5zZXF1ZWxpemUudHJhbnNhY3Rpb24oKHQ6IFRyYW5zYWN0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRiLlVzZXJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmRCeUlkKGF1dGhVc2VyLmlkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigodXNlcjogVXNlckluc3RhbmNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKCF1c2VyLCBgVXNlciB3aXRoIGlkICR7YXV0aFVzZXIuaWR9IG5vdCBmb3VuZGApXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlci51cGRhdGUoaW5wdXQsIHsgdHJhbnNhY3Rpb246IHQgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigodXNlcjogVXNlckluc3RhbmNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXVzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpXG4gICAgICAgIH0pLFxuXG4gICAgICAgIGRlbGV0ZVVzZXI6IGNvbXBvc2UoLi4uYXV0aFJlc29sdmVycykoKHVzZXI6IFVzZXJJbnN0YW5jZSwgYXJncywgeyBkYiwgYXV0aFVzZXIgfTogeyBkYjogRGJDb25uZWN0aW9uLCBhdXRoVXNlcjogQXV0aFVzZXIgfSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRiLnNlcXVlbGl6ZS50cmFuc2FjdGlvbigodDogVHJhbnNhY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGIuVXNlclxuICAgICAgICAgICAgICAgICAgICAuZmluZEJ5SWQoYXV0aFVzZXIuaWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCh1c2VyOiBVc2VySW5zdGFuY2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3IoIXVzZXIsIGBVc2VyIHdpdGggaWQgJHthdXRoVXNlci5pZH0gbm90IGZvdW5kYClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLmRlc3Ryb3koeyB0cmFuc2FjdGlvbjogdCB9KVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpXG4gICAgICAgIH0pXG4gICAgfVxuXG59Il19